<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JW.org Meeting Content API - Documentation</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 1.8em;
        }
        .header p {
            margin: 0;
            opacity: 0.9;
        }
        .nav-tabs {
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
            padding: 0 20px;
            display: flex;
            gap: 0;
        }
        .nav-tab {
            background: none;
            border: none;
            padding: 15px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            color: #495057;
            font-weight: 500;
        }
        .nav-tab:hover {
            background: #e9ecef;
            color: #007bff;
        }
        .nav-tab.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background: white;
        }
        .content {
            height: calc(100vh - 150px);
        }
        .tab-content {
            display: none;
            height: 100%;
        }
        .tab-content.active {
            display: block;
        }
        #swagger-ui {
            height: 100%;
        }
        .examples-content {
            padding: 20px;
            height: calc(100% - 40px);
            overflow-y: auto;
            background: #f8f9fa;
        }
        .example-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .example-card h3 {
            margin-top: 0;
            color: #495057;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            margin: 10px 0;
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
        }
        .language-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        .lang-tab {
            background: #e9ecef;
            border: none;
            padding: 8px 15px;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            color: #495057;
        }
        .lang-tab.active {
            background: #007bff;
            color: white;
        }
        .lang-content {
            display: none;
        }
        .lang-content.active {
            display: block;
        }
        .endpoint-list {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .endpoint-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 4px solid #007bff;
        }
        .endpoint-method {
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 12px;
            min-width: 45px;
            text-align: center;
        }
        .endpoint-url {
            font-family: monospace;
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 4px;
            margin-right: 12px;
            flex: 1;
        }
        .endpoint-description {
            color: #6c757d;
            font-size: 14px;
        }
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>🔗 JW.org Meeting Content API</h1>
        <p>Documentación completa de la API automatizada para contenido de reuniones</p>
    </div>

    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showTab('swagger')">📋 API Specification</button>
        <button class="nav-tab" onclick="showTab('examples')">💻 Code Examples</button>
        <button class="nav-tab" onclick="showTab('endpoints')">🔗 Quick Reference</button>
    </div>

    <div class="content">
        <!-- Swagger UI Tab -->
        <div id="swagger-tab" class="tab-content active">
            <div id="swagger-ui"></div>
        </div>

        <!-- Examples Tab -->
        <div id="examples-tab" class="tab-content">
            <div class="examples-content">
                <div class="example-card">
                    <h3>🚀 Inicio Rápido</h3>
                    <p>Obtén los datos de la semana más reciente con una simple petición:</p>
                    
                    <div class="language-tabs">
                        <button class="lang-tab active" onclick="showLang(this, 'js-quick')">JavaScript</button>
                        <button class="lang-tab" onclick="showLang(this, 'python-quick')">Python</button>
                        <button class="lang-tab" onclick="showLang(this, 'curl-quick')">cURL</button>
                    </div>

                    <div id="js-quick" class="lang-content active">
                        <div class="code-block">
// Obtener la semana más reciente
fetch('https://neri-gut.github.io/jw-scraping/latest.json')
  .then(response => response.json())
  .then(data => {
    console.log('Semana:', data.weekOf);
    console.log('Reuniones:', data.meetings.length);
    console.log('Total materiales:', data.stats.totalMaterials);
  })
  .catch(error => console.error('Error:', error));
                        </div>
                    </div>

                    <div id="python-quick" class="lang-content">
                        <div class="code-block">
import requests

# Obtener la semana más reciente
response = requests.get('https://neri-gut.github.io/jw-scraping/latest.json')
data = response.json()

print(f"Semana: {data['weekOf']}")
print(f"Reuniones: {len(data['meetings'])}")
print(f"Total materiales: {data['stats']['totalMaterials']}")
                        </div>
                    </div>

                    <div id="curl-quick" class="lang-content">
                        <div class="code-block">
# Obtener la semana más reciente
curl -H "Accept: application/json" \
     https://neri-gut.github.io/jw-scraping/latest.json
                        </div>
                    </div>
                </div>

                <div class="example-card">
                    <h3>📅 Trabajar con Datos de Semanas</h3>
                    <p>Cómo obtener y procesar datos de semanas específicas:</p>
                    
                    <div class="language-tabs">
                        <button class="lang-tab active" onclick="showLang(this, 'js-weeks')">JavaScript</button>
                        <button class="lang-tab" onclick="showLang(this, 'python-weeks')">Python</button>
                    </div>

                    <div id="js-weeks" class="lang-content active">
                        <div class="code-block">
async function getWeeklyData() {
  try {
    // Obtener lista de semanas disponibles
    const weeksResponse = await fetch('https://neri-gut.github.io/jw-scraping/weeks.json');
    const weeksData = await weeksResponse.json();
    
    console.log(`Total semanas disponibles: ${weeksData.meta.totalWeeks}`);
    
    // Obtener datos de una semana específica
    const specificWeek = weeksData.weeks[0]; // Primera semana disponible
    const weekResponse = await fetch(`https://neri-gut.github.io/jw-scraping/${specificWeek.dataUrl}`);
    const weekData = await weekResponse.json();
    
    // Procesar reuniones
    weekData.meetings.forEach(meeting => {
      console.log(`Reunión: ${meeting.title}`);
      console.log(`Tipo: ${meeting.type}`);
      console.log(`Duración: ${meeting.totalDuration} minutos`);
      console.log(`Materiales: ${Object.values(meeting.materials).flat().length}`);
    });
    
  } catch (error) {
    console.error('Error obteniendo datos:', error);
  }
}

getWeeklyData();
                        </div>
                    </div>

                    <div id="python-weeks" class="lang-content">
                        <div class="code-block">
import requests
from datetime import datetime

def get_weekly_data():
    try:
        # Obtener lista de semanas disponibles
        weeks_response = requests.get('https://neri-gut.github.io/jw-scraping/weeks.json')
        weeks_data = weeks_response.json()
        
        print(f"Total semanas disponibles: {weeks_data['meta']['totalWeeks']}")
        
        # Obtener datos de una semana específica
        specific_week = weeks_data['weeks'][0]  # Primera semana disponible
        week_url = f"https://neri-gut.github.io/jw-scraping/{specific_week['dataUrl']}"
        week_response = requests.get(week_url)
        week_data = week_response.json()
        
        # Procesar reuniones
        for meeting in week_data['meetings']:
            print(f"Reunión: {meeting['title']}")
            print(f"Tipo: {meeting['type']}")
            print(f"Duración: {meeting['totalDuration']} minutos")
            
            # Contar materiales
            total_materials = sum(len(materials) for materials in meeting['materials'].values())
            print(f"Materiales: {total_materials}")
            print("-" * 30)
            
    except requests.RequestException as error:
        print(f"Error obteniendo datos: {error}")

get_weekly_data()
                        </div>
                    </div>
                </div>

                <div class="example-card">
                    <h3>📊 Análisis de Estadísticas</h3>
                    <p>Cómo acceder y analizar las estadísticas de la API:</p>
                    
                    <div class="language-tabs">
                        <button class="lang-tab active" onclick="showLang(this, 'js-stats')">JavaScript</button>
                        <button class="lang-tab" onclick="showLang(this, 'python-stats')">Python</button>
                    </div>

                    <div id="js-stats" class="lang-content active">
                        <div class="code-block">
async function analyzeStats() {
  try {
    const response = await fetch('https://neri-gut.github.io/jw-scraping/stats.json');
    const stats = await response.json();
    
    console.log('📊 Estadísticas Generales:');
    console.log(`Total semanas: ${stats.overview.totalWeeks}`);
    console.log(`Total reuniones: ${stats.overview.totalMeetings}`);
    console.log(`Total materiales: ${stats.overview.totalMaterials}`);
    
    console.log('\n📅 Por tipo de reunión:');
    Object.entries(stats.byMeetingType).forEach(([type, data]) => {
      console.log(`${type}: ${data.count} reuniones, promedio ${data.avgDuration} min`);
    });
    
    console.log('\n📱 Por tipo de material:');
    Object.entries(stats.byMaterialType).forEach(([type, count]) => {
      console.log(`${type}: ${count}`);
    });
    
    console.log('\n📈 Calidad de datos:');
    console.log(`Promedio materiales por semana: ${stats.quality.avgMaterialsPerWeek}`);
    console.log(`Semanas con errores: ${stats.quality.weeksWithErrors}`);
    
  } catch (error) {
    console.error('Error:', error);
  }
}

analyzeStats();
                        </div>
                    </div>

                    <div id="python-stats" class="lang-content">
                        <div class="code-block">
import requests
import json

def analyze_stats():
    try:
        response = requests.get('https://neri-gut.github.io/jw-scraping/stats.json')
        stats = response.json()
        
        print('📊 Estadísticas Generales:')
        print(f"Total semanas: {stats['overview']['totalWeeks']}")
        print(f"Total reuniones: {stats['overview']['totalMeetings']}")
        print(f"Total materiales: {stats['overview']['totalMaterials']}")
        
        print('\n📅 Por tipo de reunión:')
        for meeting_type, data in stats['byMeetingType'].items():
            print(f"{meeting_type}: {data['count']} reuniones, promedio {data['avgDuration']} min")
        
        print('\n📱 Por tipo de material:')
        for material_type, count in stats['byMaterialType'].items():
            print(f"{material_type}: {count}")
        
        print('\n📈 Calidad de datos:')
        print(f"Promedio materiales por semana: {stats['quality']['avgMaterialsPerWeek']}")
        print(f"Semanas con errores: {stats['quality']['weeksWithErrors']}")
        
    except requests.RequestException as error:
        print(f"Error: {error}")

analyze_stats()
                        </div>
                    </div>
                </div>

                <div class="example-card">
                    <h3>🔄 Manejo de Errores y Mejores Prácticas</h3>
                    <p>Implementación robusta con manejo de errores:</p>
                    
                    <div class="language-tabs">
                        <button class="lang-tab active" onclick="showLang(this, 'js-robust')">JavaScript</button>
                        <button class="lang-tab" onclick="showLang(this, 'python-robust')">Python</button>
                    </div>

                    <div id="js-robust" class="lang-content active">
                        <div class="code-block">
class JWMeetingAPI {
  constructor(baseUrl = 'https://neri-gut.github.io/jw-scraping') {
    this.baseUrl = baseUrl;
    this.cache = new Map();
    this.cacheTimeout = 1000 * 60 * 60; // 1 hora
  }

  async request(endpoint) {
    const url = `${this.baseUrl}/${endpoint}`;
    
    // Verificar caché
    if (this.cache.has(url)) {
      const cached = this.cache.get(url);
      if (Date.now() - cached.timestamp < this.cacheTimeout) {
        return cached.data;
      }
    }

    try {
      const response = await fetch(url);
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const data = await response.json();
      
      // Guardar en caché
      this.cache.set(url, {
        data,
        timestamp: Date.now()
      });
      
      return data;
      
    } catch (error) {
      console.error(`Error fetching ${url}:`, error);
      throw error;
    }
  }

  async getLatest() {
    return this.request('latest.json');
  }

  async getWeeks() {
    return this.request('weeks.json');
  }

  async getWeekData(year, weekNumber) {
    const paddedWeek = weekNumber.toString().padStart(2, '0');
    return this.request(`data/${year}/week-${paddedWeek}.json`);
  }

  async getStats() {
    return this.request('stats.json');
  }
}

// Uso
const api = new JWMeetingAPI();

api.getLatest()
  .then(data => console.log('Última semana:', data.weekOf))
  .catch(error => console.error('Error:', error));
                        </div>
                    </div>

                    <div id="python-robust" class="lang-content">
                        <div class="code-block">
import requests
import time
from typing import Dict, Any, Optional

class JWMeetingAPI:
    def __init__(self, base_url: str = "https://neri-gut.github.io/jw-scraping"):
        self.base_url = base_url
        self.cache: Dict[str, Dict[str, Any]] = {}
        self.cache_timeout = 3600  # 1 hora en segundos
        self.session = requests.Session()
        self.session.headers.update({
            'User-Agent': 'JW-Meeting-API-Client/1.0'
        })

    def _request(self, endpoint: str) -> Dict[str, Any]:
        url = f"{self.base_url}/{endpoint}"
        
        # Verificar caché
        if url in self.cache:
            cached = self.cache[url]
            if time.time() - cached['timestamp'] < self.cache_timeout:
                return cached['data']

        try:
            response = self.session.get(url, timeout=10)
            response.raise_for_status()
            
            data = response.json()
            
            # Guardar en caché
            self.cache[url] = {
                'data': data,
                'timestamp': time.time()
            }
            
            return data
            
        except requests.RequestException as error:
            print(f"Error fetching {url}: {error}")
            raise

    def get_latest(self) -> Dict[str, Any]:
        """Obtener datos de la semana más reciente"""
        return self._request('latest.json')

    def get_weeks(self) -> Dict[str, Any]:
        """Obtener lista de todas las semanas disponibles"""
        return self._request('weeks.json')

    def get_week_data(self, year: int, week_number: int) -> Dict[str, Any]:
        """Obtener datos de una semana específica"""
        padded_week = str(week_number).zfill(2)
        return self._request(f'data/{year}/week-{padded_week}.json')

    def get_stats(self) -> Dict[str, Any]:
        """Obtener estadísticas de la API"""
        return self._request('stats.json')

# Uso
api = JWMeetingAPI()

try:
    latest = api.get_latest()
    print(f"Última semana: {latest['weekOf']}")
    
    stats = api.get_stats()
    print(f"Total materiales: {stats['overview']['totalMaterials']}")
    
except Exception as error:
    print(f"Error: {error}")
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Reference Tab -->
        <div id="endpoints-tab" class="tab-content">
            <div class="examples-content">
                <div class="endpoint-list">
                    <h3><span class="status-indicator"></span>Endpoints Disponibles</h3>
                    
                    <div class="endpoint-item">
                        <span class="endpoint-method">GET</span>
                        <span class="endpoint-url">/index.json</span>
                        <span class="endpoint-description">Información general de la API y metadatos</span>
                    </div>
                    
                    <div class="endpoint-item">
                        <span class="endpoint-method">GET</span>
                        <span class="endpoint-url">/latest.json</span>
                        <span class="endpoint-description">Datos completos de la semana más reciente</span>
                    </div>
                    
                    <div class="endpoint-item">
                        <span class="endpoint-method">GET</span>
                        <span class="endpoint-url">/weeks.json</span>
                        <span class="endpoint-description">Lista de todas las semanas disponibles</span>
                    </div>
                    
                    <div class="endpoint-item">
                        <span class="endpoint-method">GET</span>
                        <span class="endpoint-url">/stats.json</span>
                        <span class="endpoint-description">Estadísticas detalladas de la API</span>
                    </div>
                    
                    <div class="endpoint-item">
                        <span class="endpoint-method">GET</span>
                        <span class="endpoint-url">/data/{year}/week-{nn}.json</span>
                        <span class="endpoint-description">Datos específicos de una semana (nn con ceros)</span>
                    </div>
                </div>

                <div class="example-card">
                    <h3>🔧 Características de la API</h3>
                    <ul>
                        <li><strong>CORS habilitado:</strong> Funciona directamente desde el navegador</li>
                        <li><strong>Sin autenticación:</strong> Acceso libre y público</li>
                        <li><strong>Sin límites de rate:</strong> Uso responsable recomendado</li>
                        <li><strong>Formato JSON:</strong> Todas las respuestas en formato JSON estándar</li>
                        <li><strong>Actualización automática:</strong> Contenido actualizado semanalmente</li>
                        <li><strong>Versionado:</strong> API versionada para compatibilidad</li>
                    </ul>
                </div>

                <div class="example-card">
                    <h3>📱 Estructura de Datos</h3>
                    <p>Cada semana contiene:</p>
                    <ul>
                        <li><strong>Metadatos:</strong> ID, fechas, número de semana</li>
                        <li><strong>Reuniones:</strong> Midweek y weekend con secciones detalladas</li>
                        <li><strong>Materiales:</strong> Videos, imágenes, audio y cánticos</li>
                        <li><strong>Estadísticas:</strong> Conteos y duraciones</li>
                        <li><strong>URLs fuente:</strong> Enlaces a las páginas originales de JW.org</li>
                    </ul>
                </div>

                <div class="example-card">
                    <h3>⚡ URLs de Ejemplo</h3>
                    <div class="code-block">
# Base URL
https://neri-gut.github.io/jw-scraping/

# Endpoints principales
https://neri-gut.github.io/jw-scraping/latest.json
https://neri-gut.github.io/jw-scraping/weeks.json
https://neri-gut.github.io/jw-scraping/stats.json

# Datos específicos
https://neri-gut.github.io/jw-scraping/data/2025/week-31.json
https://neri-gut.github.io/jw-scraping/data/2025/week-01.json
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist@5.9.0/swagger-ui-standalone-preset.js"></script>
    <script>
        // Initialize Swagger UI
        const ui = SwaggerUIBundle({
            url: './openapi.yaml',
            dom_id: '#swagger-ui',
            deepLinking: true,
            presets: [
                SwaggerUIBundle.presets.apis,
                SwaggerUIStandalonePreset
            ],
            plugins: [
                SwaggerUIBundle.plugins.DownloadUrl
            ],
            layout: "StandaloneLayout",
            tryItOutEnabled: true,
            requestInterceptor: (request) => {
                // Add any custom headers or modifications here
                return request;
            },
            responseInterceptor: (response) => {
                // Process responses if needed
                return response;
            }
        });

        // Tab switching functionality
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName + '-tab').classList.add('active');
            
            // Add active class to clicked nav tab
            event.target.classList.add('active');
        }

        // Language switching for code examples
        function showLang(button, langId) {
            const container = button.closest('.example-card');
            
            // Remove active class from all language tabs in this container
            container.querySelectorAll('.lang-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Hide all language content in this container
            container.querySelectorAll('.lang-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show selected language content
            document.getElementById(langId).classList.add('active');
            
            // Add active class to clicked language tab
            button.classList.add('active');
        }

        // Copy code functionality
        function addCopyButtons() {
            document.querySelectorAll('.code-block').forEach(block => {
                const button = document.createElement('button');
                button.textContent = 'Copy';
                button.style.cssText = `
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    background: #007bff;
                    color: white;
                    border: none;
                    padding: 5px 10px;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 12px;
                `;
                
                block.style.position = 'relative';
                block.appendChild(button);
                
                button.addEventListener('click', () => {
                    navigator.clipboard.writeText(block.textContent.replace('Copy', '')).then(() => {
                        button.textContent = 'Copied!';
                        setTimeout(() => {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                });
            });
        }

        // Initialize copy buttons when page loads
        document.addEventListener('DOMContentLoaded', addCopyButtons);
    </script>
</body>
</html>